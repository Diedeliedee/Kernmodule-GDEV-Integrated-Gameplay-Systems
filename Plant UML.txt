@startuml

class GameManager
{
  -serivceLocator : ServiceLocator
  -inventoryManager : InventoryManager
  -tickManager : TickManager
  +Awake() : void
  +Start() : void
  +Update() : void
}

package "Service Locator"
{
  class ServiceLocator
  {
    -services : Dictionary<Type, IService>
    +Add(...) : void
    +Remove(...) : void
    +Get<T>() : void
  }
  
  interface IService
  
  GameManager *-- ServiceLocator
  ServiceLocator o.. IService
}

package "Tick System"
{
  class TickManager
  {
    -subscribed : List<IUpdatable> 
    +OnUpdate() : void
    +Add<T>(updatable : T) : T
  }
  
  interface IUpdatable
  
  GameManager *-- TickManager
  TickManager o.. IUpdatable
}

package "Gathering System"
{
  class GatherManager <<Updatable>>
  {
    -gatherInfo : GatherInfo
    -inventory : IInventory
  }

  class GatherInfo
  {
    -gatherItems : Dictionary<ItemData, GatherChance>
  }
  
  struct GatherChance
  {
    +gatherChancePercentage : float
    +maxStackSize : int
  }

  GameManager *-- GatherManager
  GatherManager *-- GatherInfo
  GatherInfo o-- GatherChance
}

package "Crafting System"
{
  class CraftingManager <<Updatable>>
  {
    -inventory : IInventory
    -lockedRecipes : List<CraftingRecipe>
    -unlockedRecipes : List<CraftingRecipe>
    -recipeQueue : Que<CraftingRecipe>
    +CanBeCrafted(recipe : CraftingRecipe) : bool
    +QueueCraft(recipe : CraftingRecipe) : void
    +Craft(recipe : CraftingRecipe) : void
    +CheckForRecipeUnlocks()
  }

  class CraftingRecipe <<ScriptableObject>>
  {
    +Input : itemStack[]
    +Output : itemStack[]
    +Duration : int
  
  }
  
  GameManager *-- CraftingManager
  CraftingManager o-- CraftingRecipe
}

package "Inventory System"
{
  class InventoryManager
  {
    -root : RectTransform
    -settings : GridSettings
    -inventory : GridInventory
    -elementGrid : SlotElement[,]
    -InstantiateGrid(_gridRes : Vector2Int, _gridSize : Vector2Int, tiles : Tile[,])
  }
  
  class SlotElement
  {
    -connectedTile : Tile
    -itemImage : Image
    -itemText : TextMeshProUGUI
    -OnTileAltered() : void
  }
  
  class GridSettings <<ScriptableObject>>
  {
    +Resolution : Vector2Int
  }

  class GridInventory <<Service>> implements IInventory
  {
    -itemGrid : Tile[]
  }
  
  class Tile
  {
    +OnAltered : event Action<ItemStack>
    -contents : ItemStack
    +SetContents() : void
    +ChangeValue(amount : int) : void
  }

  interface IInventory
  {
    +Add(itemStack : params ItemStack[]) : void
    +Remove(itemStack : params ItemStack[]) : void
    +Contains(itemStack : params ItemStack[]) : bool
  }
  
  struct ItemStack
  {
    +Type : ItemData
    +Amount : int
  }
  
  class ItemData
  {
    +Image : Sprite
  }
  
  GameManager *-- InventoryManager
  InventoryManager o-- GridSettings
  InventoryManager *-- SlotElement
  GridInventory *-- Tile
  SlotElement *-- Tile
  IInventory --> ItemStack
  ItemStack *-- ItemData
}

package "Interaction System" <<cut>>
{
  class InteractionManager <<Service, Updatable>>
  {
    -subscribedElements : Dictionary<RectTransform, IInteractable>
    -selectedElement : RectTransform
    +Subscribe(element : IInteractable, key : RectTransform)
  }

  interface IInteractable
  {
    +OnClick(mousePos : Vector2) : void
    +OnRelease(mousePos : Vector2) : void
  }
  
  abstract class BaseInteractable implements IInteractable
  {
    -element : RectTransform
    +BaseInteractable()
  }
  
  InteractionManager o.. IInteractable
}

@enduml